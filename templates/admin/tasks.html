{% extends "base.html" %} {% block title %}Gestion des Tâches - Admin - Flask
Task Manager{% endblock %} {% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Gestion des Tâches</h1>
  <a href="{{ url_for('create_task') }}" class="btn btn-primary">
    <i class="fas fa-plus"></i> Nouvelle Tâche
  </a>
</div>

<div class="card shadow">
  <div
    class="card-header bg-dark text-white d-flex justify-content-between align-items-center"
  >
    <h5 class="mb-0">Toutes les Tâches</h5>
    <div>
      <a href="{{ url_for('pending_tasks') }}" class="btn btn-sm btn-warning">
        <i class="fas fa-clock"></i> Tâches en attente {% if pending_count > 0
        %}
        <span class="badge bg-danger ms-1">{{ pending_count }}</span>
        {% endif %}
      </a>
    </div>
  </div>
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>ID</th>
            <th>Titre</th>
            <th>Utilisateur</th>
            <th>Statut</th>
            <th>Priorité</th>
            <th>Date d'échéance</th>
            <th>Date de création</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for task in tasks %}
          <tr>
            <td>{{ task.id }}</td>
            <td>{{ task.title|truncate(20) }}</td>
            <td>{{ task.user.username }}</td>
            <td>
              <span
                class="badge bg-{% if task.status == 'completed' %}success{% elif task.status == 'in_progress' %}primary{% else %}warning{% endif %}"
              >
                {% if task.status == 'completed' %}Terminé{% elif task.status ==
                'in_progress' %}En cours{% else %}En attente{% endif %}
              </span>
            </td>
            <td>
              <span
                class="badge bg-{% if task.priority == 'high' %}danger{% elif task.priority == 'medium' %}warning{% else %}info{% endif %}"
              >
                {{ task.priority|upper }}
              </span>
            </td>
            <td>
              {% if task.due_date %} {{ task.due_date.strftime('%d/%m/%Y') }} {%
              else %}
              <span class="text-muted">Non définie</span>
              {% endif %}
            </td>
            <td>{{ task.created_at.strftime('%d/%m/%Y') }}</td>
            <td>
              <div class="btn-group" role="group">
                <a
                  href="{{ url_for('view_task', task_id=task.id) }}"
                  class="btn btn-sm btn-info"
                >
                  <i class="fas fa-eye"></i>
                </a>
                <a
                  href="{{ url_for('update_task', task_id=task.id) }}"
                  class="btn btn-sm btn-warning"
                >
                  <i class="fas fa-edit"></i>
                </a>
                <a
                  href="{{ url_for('delete_task', task_id=task.id) }}"
                  class="btn btn-sm btn-danger"
                  onclick="return confirm('Êtes-vous sûr de vouloir supprimer cette tâche ?')"
                >
                  <i class="fas fa-trash"></i>
                </a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    {% if tasks.pages > 1 %}
    <nav aria-label="Page navigation" class="mt-4">
      <ul class="pagination justify-content-center">
        {% if tasks.has_prev %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('admin_tasks', page=tasks.prev_num) }}"
            >Précédent</a
          >
        </li>
        {% else %}
        <li class="page-item disabled">
          <span class="page-link">Précédent</span>
        </li>
        {% endif %} {% for page_num in tasks.iter_pages(left_edge=1,
        right_edge=1, left_current=2, right_current=2) %} {% if page_num %} {%
        if tasks.page == page_num %}
        <li class="page-item active">
          <span class="page-link">{{ page_num }}</span>
        </li>
        {% else %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('admin_tasks', page=page_num) }}"
            >{{ page_num }}</a
          >
        </li>
        {% endif %} {% else %}
        <li class="page-item disabled">
          <span class="page-link">...</span>
        </li>
        {% endif %} {% endfor %} {% if tasks.has_next %}
        <li class="page-item">
          <a
            class="page-link"
            href="{{ url_for('admin_tasks', page=tasks.next_num) }}"
            >Suivant</a
          >
        </li>
        {% else %}
        <li class="page-item disabled">
          <span class="page-link">Suivant</span>
        </li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  </div>
</div>
{% endblock %}
